<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
      
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Some JavaScript SVG Plot Examples</title>

<link href="simple.css" rel="stylesheet" type="text/css"></link>
<link href="interpreter/interpreter.css" rel="stylesheet" type="text/css"></link>

<script type="text/javascript" src="../MochiKit/MochiKit.js"></script>
<script type="text/javascript" src="interpreter/interpreter.js"></script>

<script type="text/javascript" src="../MochiKit/SVG.js" ></script>
<!--
<script type="text/javascript" src="../MochiKit/SVGCanvas.js" ></script>
-->
<script type="text/javascript">

function testRect(svg_id) {
    log("Getting SVG")
    var svg = new MochiKit.SVG(svg_id);
    log("Got svg = ", svg);
    var newRect = svg.RECT({'x':10, 'y':10, 'width':80, 'height':80, 'fill':'blue', 'fill-opacity':.5});
    svg.append(newRect);
    svg.append( svg.CIRCLE( {'cx':50, 'cy':50, 'r':20, 'fill':'purple', 'fill-opacity':.3} ) );
}

function testCreate(type) {
    var svg = new MochiKit.SVG(100, 100, 'new_'+type+'htmlElement', type);
    appendChildNodes('new_'+type, svg.htmlElement);
    var init = function () {
        log("htmlElemnt = " + svg.htmlElement);
        log("svgDocument = " + svg.svgDocument);
        log("svgElement = " + svg.svgElement);
        var newRect = svg.RECT( {'x':10, 'y':10, 'width':80, 'height':80, 'fill':'blue'} );
        svg.append(newRect);
        svg.append( svg.CIRCLE( {'cx':50, 'cy':50, 'r':20, 'fill':'red'} ) ); 
    }
    svg.whenReady(init);
}

function testLoad(type) {
    var svg = new MochiKit.SVG('../svgplot/example.svg', 'load_'+type+'htmlElement', type);
    appendChildNodes('load_'+type, svg.htmlElement);
}

/*
function testCanvas() {
    var svg = new MochiKit.SVG(200, 200);
    log("1st svg = " + svg);
    appendChildNodes(getElement('mydiv'), svg.htmlElement);
    var init = function () {
        log("2nd svg = " + svg);
        ctx = new MochiKit.SVGCanvas(svg);
        ctx.fillStyle = "#5F005F";
        ctx.fillRect(20, 20, 40, 40);
    }
    svg.whenReady(init);
}

function testBowTie() {
    // http://developer.mozilla.org/en/docs/Drawing_Graphics_with_Canvas
    var svg = new MochiKit.SVG(200, 200);
    appendChildNodes(getElement('mydiv'), svg.htmlElement);
    var init = function () {
        draw(svg);
        appendChildNodes($('codediv'), PRE(null,svg.toXML()));
    }
    svg.whenReady(init);
}

function drawBowtie(ctx, fillStyle) {
 
   ctx.fillStyle = "rgba(200,200,200,0.3)";
   ctx.fillRect(-30, -30, 60, 60);
 
   ctx.fillStyle = fillStyle;
   ctx.globalAlpha = 1.0;
   ctx.beginPath();
   ctx.moveTo(25, 25);
   ctx.lineTo(-25, -25);
   ctx.lineTo(25, -25);
   ctx.lineTo(-25, 25);
   ctx.closePath();
   ctx.fill();
 }
 
 function dot(ctx) {
   ctx.save();
   ctx.fillStyle = "black";
   ctx.fillRect(-2, -2, 4, 4);
   ctx.restore();
 }
 
 function draw(svg) {
   //var canvas = document.getElementById("canvas");
   //var ctx = canvas.getContext("2d");
   var ctx = new MochiKit.SVGCanvas(svg);

   // note that all other translates are relative to this
   // one
   ctx.translate(45, 45);

   ctx.save();
   //ctx.translate(0, 0); // unnecessary
   drawBowtie(ctx, "red");
   dot(ctx);
   ctx.restore();
 
   ctx.save();
   ctx.translate(85, 0);
   ctx.rotate(45 * Math.PI / 180);
   drawBowtie(ctx, "green");
   dot(ctx);
   ctx.restore();
 
   ctx.save();
   ctx.translate(0, 85);
   ctx.rotate(135 * Math.PI / 180);
   drawBowtie(ctx, "blue");
   dot(ctx);
   ctx.restore();
 
   ctx.save();
   ctx.translate(85, 85);
   ctx.rotate(90 * Math.PI / 180);
   drawBowtie(ctx, "yellow");
   dot(ctx);
   ctx.restore();
 }

 function testBoxes() {
    // http://developer.mozilla.org/en/docs/Drawing_Graphics_with_Canvas
    // http://developer.mozilla.org/en/docs/Canvas_tutorial:Drawing_shapes
    var init = function () {
        var ctx = new MochiKit.SVGCanvas(svg);
        ctx.strokeRect(0,0,200-1,200-1);
        ctx.fillRect(25,25,100,100);
        ctx.clearRect(45,45,60,60);
        ctx.strokeRect(50,50,50,50);
        //appendChildNodes($('codediv'), PRE(null,svg.xmlSource()));
    } 
    var svg = new MochiKit.SVG(200, 200);
    addToCallStack(svg.htmlElement, 'onload', init);
    appendChildNodes(getElement('mydiv'), svg.htmlElement);
}
*/
addLoadEvent(partial(testLoad, 'embed'));
addLoadEvent(partial(testLoad, 'object'));
addLoadEvent(partial(testRect, 'embed1'));
addLoadEvent(partial(testRect, 'object1'));
addLoadEvent(partial(testCreate, 'embed'));
addLoadEvent(partial(testCreate, 'object'));
//addLoadEvent(testCreate);
//addLoadEvent(testCanvas);
//addLoadEvent(testBoxes);
//addLoadEvent(testBowTie);

</script>

</head>

<body>

<table id="tests" border="1">
<tr>
<td align="center"><strong>Description</strong></td>
<td align="center"><strong>Embed</strong></td>
<td align="center"><strong>Object</strong></td>
<td align="center"><strong>SVG</strong></td>
</tr>


<tr>
<td>Load SVG</td>
<td id="load_embed"></td>
<td id="load_object"></td>
<td id="load_svg"></td>
</tr>

<tr>
<td>Manipulate Existing SVG</td>
<td>
    <embed  id="embed1" src="example.svg" width="150" height="150"
            type="image/svg+xml"
            pluginspage="http://www.adobe.com/svg/viewer/install/"></embed>
</td>
<td>
    <object id="object1" data="example.svg" width="150" height="150" type="image/svg+xml">
        You can't display SVG.
    </object>
</td>
<td>
<!--
    <svg id="svg1" xmlns="http://www.w3.org/2000/svg" width="100" height="100">
        <rect x="10" y="10" width="80" height="80" style="fill:blue; stroke:black;" />
    </svg>
-->
</td>
</tr>

<tr>
<td>New SVG</td>
<td id="new_embed"></td>
<td id="new_object"></td>
<td id="new_svg"></td>
</tr>



</table>


<p>What follows is a pool of empty SVGs 100x100</p>
<embed  id="empty" src="../MochiKit/empty.svg" width="100" height="100"
        type="image/svg+xml"
        pluginspage="http://www.adobe.com/svg/viewer/install/"></embed>
<embed  id="empty1" src="../MochiKit/empty.svg" width="100" height="100"
        type="image/svg+xml"
        pluginspage="http://www.adobe.com/svg/viewer/install/"></embed>
<embed  id="empty2" src="../MochiKit/empty.svg" width="100" height="100"
        type="image/svg+xml"
        pluginspage="http://www.adobe.com/svg/viewer/install/"></embed>
<embed  id="empty3" src="../MochiKit/empty.svg" width="100" height="100"
        type="image/svg+xml"
        pluginspage="http://www.adobe.com/svg/viewer/install/"></embed>
<embed  id="empty4" src="../MochiKit/empty.svg" width="100" height="100"
        type="image/svg+xml"
        pluginspage="http://www.adobe.com/svg/viewer/install/"></embed>




<div id="mydiv"></div>
<div id="codediv"></div>


<form id="interpreter_form" action="javascript:void(0);">
    <div>
        <div id="interpreter_area">
            <div id="interpreter_output"></div>
        </div>
        <input id="interpreter_text" name="input_text" type="text" class="textbox" size="100" />
    </div>
</form>
<p>MochiKit Logger: <a href="javascript:MochiKit.Logging.logger.debuggingBookmarklet()">
javascript:MochiKit.Logging.logger.debuggingBookmarklet()</a></p>

<ul>
<li>Grab an embed, object, iframe, inline and manipulate it</li>
<li>Manipulate self-registered SVGs.</li>
<li>Insert a new (embed, object, iframe, inline) from a file</li>
<li>Insert a new (embed, object, iframe, inline) and manipulate it.</li>
<li>Grab an (embed, object, iframe, inline) from a pool by ID and move it, resize it, manipuate it.</li>
</ul>

</body>
</html>
